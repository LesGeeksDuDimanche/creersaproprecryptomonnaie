<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Samuel Eyre</title>

    <!-- Behavioral Meta Data -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <script src="js/vendor/w3.js"></script>
    <script src="js/vendor/reveal.js"></script>

    <link rel="stylesheet" href="./css/reveal.css">
    <link rel="stylesheet" href="./css/theme/solarized.css">
    <link rel="stylesheet" href="./lib/css/zenburn.css">

    <link rel="stylesheet" href="css/main.css">


</head>
<body>
<!--[if lt IE 8]>
<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
<![endif]-->


<div class="reveal">
    <div class="slides">
        <section>
            <img data-src="./img/bricodeurstransp-200px.png">
            <h2>Créer sa propre crypto-monnaie !</h2>
            <h5>A partir de LiteCoin 0.8.7.5</h5>
            <p><i>Basé sur le tutoriel réalisé par <a href="https://www.youtube.com/channel/UCgnaLsp9LBdRvJDppY59cvw">Aqua</a></i></p>
        </section>
        <section>
            <section>
                <h2>Préparatifs</h2>
            </section>
            <section>
                <h2>OS</h2>
                <p>
                    Ubuntu 14 ou 16
                </p>
            </section>
            <section>
                <h2>Dépendances</h2>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
sudo apt-get install git
sudo apt-get install build-essential libtool autotools-dev automake pkg-config libssl-dev libevent-dev bsdmainutils
sudo apt-get install libboost-system-dev libboost-filesystem-dev libboost-chrono-dev libboost-program-options-dev libboost-test-dev libboost-thread-dev
sudo apt-get install libboost-all-dev
sudo apt-get install software-properties-common
sudo add-apt-repository ppa:bitcoin/bitcoin
sudo apt-get update
sudo apt-get install libdb4.8-dev libdb4.8++-dev
sudo apt-get install libminiupnpc-dev
sudo apt-get install libzmq3-dev
sudo apt-get install libqt5gui5 libqt5core5a libqt5dbus5 qttools5-dev qttools5-dev-tools libprotobuf-dev protobuf-compiler
sudo apt-get install libqt4-dev libprotobuf-dev protobuf-compiler
            </code></pre>

            </section>
            <section>
                <h2>
                    Repo Github
                </h2>
                <pre><code data-trim data-noescape  class="shell hljs livecodeserver">
git clone -b 0.8 https://github.com/litecoin-project/litecoin.git
            </code></pre>

            </section>
            <section>
                <h2>corrections problème vieux paquet</h2>
                <p>
                    src/rawtransaction.cpp
                    <br>ligne 242
                    <br>Enlever : & et const
                </p>

                <pre><code data-trim data-noescape class="c++ hljs">
const CScriptID& hash = boost::get&lt<mark> const</mark>CScriptID<mark>&</mark>&gt(address);
                </code></pre>


            </section>
            <section>

                <h2>
                    Choisir un nom
                </h2>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
find . -type f -print0 | xargs -0 sed -i 's/litecoin/bricocoin/g'
find . -type f -print0 | xargs -0 sed -i 's/Litecoin/Bricocoin/g'
find . -type f -print0 | xargs -0 sed -i 's/LiteCoin/BricoCoin/g'
find . -type f -print0 | xargs -0 sed -i 's/LITECOIN/BRICOCOIN/g'
find . -type f -print0 | xargs -0 sed -i 's/LTC/BRC/g'
            </code></pre>

            </section>

            <section>

                <h2>Compilation <span>(test)</span> </h2>

                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
make -f makefile.unix
            </code></pre>

            </section>
            <section>
                <p>Vous devriez maintenant avoir un executable : funcoind </p>
            </section>
            <section>

            </section>
        </section>


        <section>
            <section>
                <h2>Configuration</h2>
            </section>
            <section>
                <h2>PORT P2P</h2>
                <p>On remplace les ports de litecoin 9333/9332 par 2333/2332 (aléatoire)</p>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
find . -type f -print0 | xargs -0 sed -i 's/9333/2333/g'
find . -type f -print0 | xargs -0 sed -i 's/9332/2332/g'
                </code></pre>
            </section>
            <section>
                <h2>Préfixe personalisé des adresses BricoCoin</h2>
                <p>fichier base58.h <br>ligne 275</p>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
PUBKEY_ADDRESS = <mark>25</mark>, // Bricocoin addresses start with <mark>B</mark>
PUBKEY_ADDRESS_TEST = <mark>85</mark>,
                </code></pre>
                <p>La liste des codes est <a href="https://en.bitcoin.it/wiki/List_of_address_prefixes">ici</a></p>
            </section>
            <section>
                <h2>Création des clefs publics / privées</h2>
                <p>A placer hors du dossier, en local</p>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
openssl ecparam -genkey -name secp256k1 -out alertkey.pem
openssl ec -in alertkey.pem -text > alertkey.hex
openssl ecparam -genkey -name secp256k1 -out testnetalert.pem
openssl ec -in testnetalert.pem -text > testnetalert.hex
openssl ecparam -genkey -name secp256k1 -out genesiscoinbase.pem
openssl ec -in testnetalert.pem -text > genesiscoinbase.hex
                </code></pre>
                <p>* <a href="https://en.bitcoin.it/wiki/Secp256k1">secp245k1</a></p>

            </section>
            <section>
                <h2>Placer la clef public de testnetalert dans alert.cpp</h2>
                <p>En supprimant les ":"</p>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
static const char* pszTestKey = "<mark>04d67f78ca51075ba965efe950ce4fac72a4a2f2109c0fd0f493418e7a877b8b1b51355fe1660ead9c05d9a7ff0dceba0d287b906ff78d059a7dd9f075a1283ef9</mark>";
                </code></pre>

            </section>
            <section>
                <h2>Placer la clef public de genesiscoinbase dans main.cpp</h2>
                <p>ligne 2788</p>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
txNew.vout[0].scriptPubKey = CScript() << ParseHex("<mark>04d67f78ca51075ba965efe950ce4fac72a4a2f2109c0fd0f493418e7a877b8b1b51355fe1660ead9c05d9a7ff0dceba0d287b906ff78d059a7dd9f075a1283ef9</mark>") << OP_CHECKSIG;
                </code></pre>
            </section>
            <section>
                <h2>PeerMagic (test net)</h2>
                <p>ligne 2745 de main.cpp</p>
                <p>(Choix aléatoires)</p>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
if (fTestNet)
    {
        pchMessageStart[0] = 0xf<mark>2</mark>;
        pchMessageStart[1] = 0xc<mark>3</mark>;
        pchMessageStart[2] = 0xb<mark>7</mark>;
        pchMessageStart[3] = 0xd<mark>4</mark>;

                </code></pre>
                <p>PeerMagic: "identifiant" qui permet d'annoncer que le message qu'on envoie concerne telle blockchain</p>
                <p>Plus d'info : <a href="https://en.bitcoin.it/wiki/Satoshi_Client_Node_Discovery">lien 1</a> <a href="https://coinlogic.wordpress.com/2014/03/09/the-bitcoin-protocol-4-network-messages-1-version/">lien 2</a> <a href="https://en.bitcoin.it/wiki/Protocol_specification#Message_structure">lien 3</a></p>

            </section>
            <section>
                <h2>PeerMagic (main)</h2>
                <p>ligne 2745 de main.cpp</p>
                <p>(Choix aléatoires)</p>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
unsigned char pchMessageStart[4] = { 0xf<mark>a</mark>, 0xc<mark>2</mark> , 0xb<mark>1</mark>, 0xd<mark>b</mark> }; // BricoCoin: increase each by adding 2 to bitcoin's value.
                </code></pre>


            </section>


            <section>
                <h2>Suppression des DNSs hardcodés</h2>
                <p>
                    ligne 1176 de test.cpp
                </p>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
static const char *strMainNetDNSSeed[][2] = {
{NULL, NULL}
};

static const char *strTestNetDNSSeed[][2] = {
{NULL, NULL}
};
                </code></pre>
            </section>
            <section>
                <h2>Suppression des IPs hardcodés</h2>
                <p>
                    lign 1226 de test.cpp
                </p>
                <p>
                    laisser "0x0" pour éviter une erreur de compilation
                </p>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
unsigned int pnSeed[] =
{
   <mark>0x0</mark>
};
                </code></pre>

            </section>
            <section>
                <h3>
                    Maintenant on est sûr qu'il n'essayera pas de se connecter au réseau LiteCoin !
                </h3>
            </section>

        </section>
        <section>

            <section>
                <h2>Paramètres de la BlockChain !</h2>
                <p>Avant de faire cette partie, testez la compilation à nouveau. </p>
            </section>
            <section>
                <h2>Proof of work</h2>
                <p>main.cpp ligne 1090</p>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
int64 static GetBlockValue(int nHeight, int64 nFees)
{
    int64 nSubsidy = <mark>10</mark> * COIN;

    // Subsidy is cut in half every 10 000 blocks, which will occur approximately every 4 years
    nSubsidy >>= (nHeight / <mark>10</mark>); // BricoCoin: 10 blocks in ~ 20 minutes

    return nSubsidy + nFees;
}

static const int64 nTargetTimespan = <mark>0.007</mark> * 24 * 60 * 60; // BricoCoin: 10 minutes
static const int64 nTargetSpacing = <mark>2</mark> * 60; // BricoCoin: 2 minutes


                    </code></pre>
            <span style="font-size: 0.3em">BitCoin : remise en question de la difficulté toutes les 2 semaines, avec pour objectif 1 block toutes les 10 minutes ( 14 * 24 * 60 / 10 ) =  2016 blocks.  <a href="https://en.bitcoin.it/wiki/Difficulty#What_network_hash_rate_results_in_a_given_difficulty.3F"> voir ici </a></span>


            </section>
            <section>
            <h2>Correction</h2>
                <p>Pourquoi c'est à deux endroits du code ? NO IDEA</p>
            <pre><code data-trim data-noescape class="shell hljs livecodeserver">
txNew.vout[0].nValue = 10 * COIN;
            </code></pre>


            </section>

            <section>
                <h2>Nombre max de BricoCoin dans une transaction</h2>
                <p>main.h ligne 55</p>
                <p> On choisit :  10 * 10 + 10 * 5 = 150 </p>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
static const int64 MAX_MONEY = <mark>150</mark> * COIN;

static const int COINBASE_MATURITY = <mark>1</mark>;
                </code></pre>

            </section>
            <section>

                <h2>Nombre de blocks avant Maturité</h2>
                <p>
                    Correction
                    main.cpp ligne 948
                </p>

                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
int CMerkleTx::GetBlocksToMaturity() const
{
if (!IsCoinBase())
return 0;
return max(0, (COINBASE_MATURITY+<mark>5</mark>) - GetDepthInMainChain());
}
                </code></pre>


            </section>
            <section>
                <h2>Période de réajustement de la difficulté </h2>
                <p>main.h ligne 627</p>
                <p> 1 block / 2 min sur une période de 10 minutes :  10 / 2 = 5 </p>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">

static bool AllowFree(double dPriority)
{
// Large (in bytes) low-priority (new, small-coin) transactions
// need a fee.
return dPriority > COIN * <mark>5</mark> / 250;
}

                </code></pre>

            </section>
            <section>
                <h2>timeStamp</h2>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
                const char* pszTimestamp = "25/01/2018 Débat autour des cryptomonnaies et les monnaies locales complémentaires!";
                </code></pre>
            </section>
            <section>
                <h2>timeStamp</h2>
                <p>Dans le terminal</p>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
                date +%s
                </code></pre>
                <p>main.cpp ligne 2794</p>
                <pre><code data-trim data-noescape class="shell hljs livecodeserver">
                 block.nTime    = 1515165286;
                </code></pre>
            </section>


        </section>

    </div>
</div>

<!--// ressources-->

<!--https://vcoin-project.github.io/cloning-litecoin/-->





<script src="js/main.js"></script>



<!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
<script>
    (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
        function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
        e=o.createElement(i);r=o.getElementsByTagName(i)[0];
        e.src='//www.google-analytics.com/analytics.js';
        r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
    ga('create','UA-XXXXX-X','auto');ga('send','pageview');
</script>
</body>
</html>
